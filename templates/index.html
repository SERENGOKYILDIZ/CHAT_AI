<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Asistan</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-bg: #0d1117;
            --secondary-bg: #161b22;
            --sidebar-bg: #21262d;
            --border-color: #30363d;
            --text-primary: #f0f6fc;
            --text-secondary: #8b949e;
            --accent-color: #58a6ff;
            --success-color: #238636;
            --warning-color: #f78166;
            --error-color: #f85149;
            --message-user-bg: #1f6feb;
            --message-bot-bg: #21262d;
            --input-bg: #0d1117;
            --hover-bg: #30363d;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Noto Sans', Helvetica, Arial, sans-serif;
            background: var(--primary-bg);
            color: var(--text-primary);
            height: 100vh;
            overflow: hidden;
            line-height: 1.6;
        }

        .app-container {
            display: flex;
            height: 100vh;
        }

        /* Sidebar Styles */
        .sidebar {
            width: 260px;
            background: var(--sidebar-bg);
            border-right: 1px solid var(--border-color);
            display: flex;
            flex-direction: column;
            flex-shrink: 0;
        }

        .sidebar-header {
            padding: 16px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .sidebar-header .logo {
            width: 32px;
            height: 32px;
            background: linear-gradient(135deg, var(--accent-color), #7c3aed);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }

        .sidebar-header:hover {
            background: var(--hover-bg);
            transition: background 0.2s ease;
        }

        .sidebar-header:hover .logo {
            transform: scale(1.05);
            transition: transform 0.2s ease;
        }

        .sidebar-header h1 {
            font-size: 18px;
            font-weight: 600;
            color: var(--text-primary);
        }

        .chat-tabs {
            flex: 1;
            overflow-y: auto;
            padding: 8px;
        }

        .chat-tab {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px;
            margin-bottom: 4px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
            color: var(--text-secondary);
            text-decoration: none;
            border: 1px solid transparent;
        }

        .chat-tab:hover {
            background: var(--hover-bg);
            color: var(--text-primary);
        }

        .chat-tab.active {
            background: var(--hover-bg);
            color: var(--text-primary);
            border-color: var(--accent-color);
        }

        .chat-tab .tab-icon {
            width: 16px;
            height: 16px;
            opacity: 0.7;
        }

        .chat-tab .tab-content {
            flex: 1;
            min-width: 0;
        }

        .chat-tab .tab-title {
            font-size: 14px;
            font-weight: 500;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            margin-bottom: 2px;
        }

        .chat-tab .tab-date {
            font-size: 11px;
            opacity: 0.6;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .chat-tab .tab-actions {
            opacity: 0;
            transition: opacity 0.2s ease;
            display: flex;
            gap: 4px;
        }

        .chat-tab:hover .tab-actions {
            opacity: 1;
        }

        .tab-actions button {
            background: none;
            border: none;
            color: var(--text-secondary);
            cursor: pointer;
            padding: 4px;
            border-radius: 4px;
            font-size: 12px;
            transition: all 0.2s ease;
        }

        .tab-actions button:hover {
            background: var(--border-color);
            color: var(--text-primary);
        }

        .tab-actions button.delete-btn:hover {
            background: var(--error-color);
            color: white;
        }

        /* Sidebar footer styles removed */

        /* Main Chat Area */
        .chat-main {
            flex: 1;
            display: flex;
            flex-direction: column;
            background: var(--primary-bg);
        }

        .chat-header {
            padding: 16px 24px;
            background: var(--secondary-bg);
            border-bottom: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .chat-header h2 {
            font-size: 20px;
            font-weight: 600;
            color: var(--text-primary);
        }

        .header-controls {
            display: flex;
            gap: 12px;
            align-items: center;
        }

        .status-indicator {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 16px;
            background: var(--success-color);
            color: white;
            border-radius: 20px;
            font-size: 13px;
            font-weight: 500;
        }

        .status-indicator.offline {
            background: var(--error-color);
        }

        .header-btn {
            padding: 8px 16px;
            background: var(--border-color);
            color: var(--text-primary);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 13px;
            font-weight: 500;
        }

        .header-btn:hover {
            background: var(--hover-bg);
            border-color: var(--accent-color);
        }

        .chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 24px;
            background: var(--primary-bg);
        }

        .message {
            display: flex;
            margin-bottom: 24px;
            animation: fadeInUp 0.4s ease;
        }

        .message.user {
            justify-content: flex-end;
        }

        .message.bot {
            justify-content: flex-start;
        }

        .message-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 12px;
            font-size: 14px;
            color: white;
            flex-shrink: 0;
        }

        .message.user .message-avatar {
            background: var(--message-user-bg);
            order: 2;
        }

        .message.bot .message-avatar {
            background: var(--accent-color);
            order: 1;
        }

        .message-content {
            max-width: 70%;
            padding: 16px 20px;
            border-radius: 12px;
            position: relative;
            word-wrap: break-word;
            line-height: 1.6;
        }

        .message.user .message-content {
            background: var(--message-user-bg);
            color: white;
            border-bottom-right-radius: 4px;
        }

        .message.bot .message-content {
            background: var(--message-bot-bg);
            color: var(--text-primary);
            border: 1px solid var(--border-color);
            border-bottom-left-radius: 4px;
        }

        .message-time {
            font-size: 12px;
            opacity: 0.7;
            margin-top: 8px;
            text-align: right;
        }

        .message.bot .message-time {
            text-align: left;
        }

        .typing-indicator {
            display: none;
            padding: 16px 20px;
            background: var(--message-bot-bg);
            border-radius: 12px;
            border: 1px solid var(--border-color);
            margin-bottom: 24px;
            max-width: 70%;
            align-self: flex-start;
            margin-left: 56px;
        }

        .typing-indicator.show {
            display: block;
        }

        .typing-dots {
            display: flex;
            gap: 4px;
        }

        .typing-dot {
            width: 6px;
            height: 6px;
            background: var(--text-secondary);
            border-radius: 50%;
            animation: typing 1.4s infinite ease-in-out;
        }

        .typing-dot:nth-child(1) { animation-delay: -0.32s; }
        .typing-dot:nth-child(2) { animation-delay: -0.16s; }

        @keyframes typing {
            0%, 80%, 100% { transform: scale(0.8); opacity: 0.5; }
            40% { transform: scale(1); opacity: 1; }
        }

        .chat-input-container {
            padding: 24px;
            background: var(--secondary-bg);
            border-top: 1px solid var(--border-color);
        }

        .chat-input-wrapper {
            display: flex;
            gap: 16px;
            align-items: flex-end;
            background: var(--input-bg);
            border-radius: 12px;
            padding: 12px;
            border: 1px solid var(--border-color);
            transition: all 0.2s ease;
            max-width: 800px;
            margin: 0 auto;
        }

        .chat-input-wrapper:focus-within {
            border-color: var(--accent-color);
            box-shadow: 0 0 0 2px rgba(88, 166, 255, 0.2);
        }

        .chat-input {
            flex: 1;
            border: none;
            background: transparent;
            padding: 12px;
            font-size: 16px;
            outline: none;
            resize: none;
            max-height: 120px;
            min-height: 24px;
            color: var(--text-primary);
            font-family: inherit;
            line-height: 1.5;
        }

        .chat-input::placeholder {
            color: var(--text-secondary);
        }

        .send-btn {
            background: var(--accent-color);
            color: white;
            border: none;
            border-radius: 8px;
            width: 40px;
            height: 40px;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            flex-shrink: 0;
        }

        .send-btn:hover {
            background: #4d9eff;
            transform: translateY(-1px);
        }

        .send-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        /* Welcome Message */
        .welcome-message {
            text-align: center;
            padding: 60px 24px;
            color: var(--text-secondary);
        }

        .welcome-message h1 {
            font-size: 32px;
            font-weight: 700;
            margin-bottom: 16px;
            color: var(--text-primary);
        }

        .welcome-message p {
            font-size: 16px;
            margin-bottom: 32px;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }

        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 24px;
            max-width: 800px;
            margin: 0 auto;
        }

        .feature-card {
            background: var(--secondary-bg);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 24px;
            text-align: center;
            transition: all 0.2s ease;
        }

        .feature-card:hover {
            border-color: var(--accent-color);
            transform: translateY(-2px);
        }

        .feature-card i {
            font-size: 32px;
            color: var(--accent-color);
            margin-bottom: 16px;
        }

        .feature-card h3 {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--text-primary);
        }

        .feature-card p {
            font-size: 14px;
            color: var(--text-secondary);
        }

        /* Animations */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Scrollbar Styling */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: var(--primary-bg);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--border-color);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--hover-bg);
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .sidebar {
                width: 100%;
                position: absolute;
                z-index: 1000;
                transform: translateX(-100%);
                transition: transform 0.3s ease;
            }

            .sidebar.show {
                transform: translateX(0);
            }

            .chat-main {
                width: 100%;
            }

            .message-content {
                max-width: 85%;
            }

            .feature-grid {
                grid-template-columns: 1fr;
            }
        }

        /* Loading States */
        .loading {
            opacity: 0.6;
            pointer-events: none;
        }

        /* Error States */
        .error-message {
            background: var(--error-color);
            color: white;
            padding: 12px 16px;
            border-radius: 8px;
            margin: 16px 24px;
                display: none;
            }
            
        .error-message.show {
            display: block;
        }

        /* Panel Styles */
        .panel {
            background: var(--secondary-bg);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            margin: 16px;
            padding: 24px;
            display: none; /* Hidden by default */
            flex-direction: column;
            gap: 16px;
        }

        .panel.show {
            display: flex;
        }

        .panel-header {
            display: flex;
            align-items: center;
            gap: 12px;
            padding-bottom: 16px;
            border-bottom: 1px solid var(--border-color);
        }

        .panel-header h2 {
            font-size: 20px;
            font-weight: 600;
            color: var(--text-primary);
        }

        .panel-content {
            flex: 1;
            overflow-y: auto;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
        }

        .stats-grid .feature-card {
                padding: 16px;
            text-align: left;
        }

        .stats-grid .feature-card i {
            font-size: 24px;
            margin-bottom: 8px;
        }

        .stats-grid .feature-card h3 {
            font-size: 16px;
            margin-bottom: 4px;
        }

        .stats-grid .feature-card p {
            font-size: 13px;
            color: var(--text-secondary);
        }

        .debug-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
            margin-bottom: 16px;
        }

        .debug-buttons .btn {
            padding: 8px 16px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .debug-buttons .btn-primary {
            background: var(--accent-color);
            color: white;
            border: none;
        }

        .debug-buttons .btn-primary:hover {
            background: #4d9eff;
        }

        .debug-buttons .btn-info {
            background: #57606a;
            color: white;
            border: none;
        }

        .debug-buttons .btn-info:hover {
            background: #6a737d;
        }

        .debug-buttons .btn-warning {
            background: #f78166;
            color: white;
            border: none;
        }

        .debug-buttons .btn-warning:hover {
            background: #f56036;
        }

        .debug-buttons .btn-danger {
            background: var(--error-color);
            color: white;
            border: none;
        }

        .debug-buttons .btn-danger:hover {
            background: #da3633;
        }

        .debug-buttons .btn-secondary {
            background: var(--border-color);
            color: var(--text-primary);
            border: none;
        }

        .debug-buttons .btn-secondary:hover {
            background: var(--hover-bg);
        }

        .debug-content {
            background: var(--primary-bg);
            border: 1px solid var(--border-color);
            border-radius: 12px;
                padding: 16px;
            font-size: 14px;
            color: var(--text-primary);
            white-space: pre-wrap; /* Preserve line breaks */
            word-wrap: break-word;
            overflow-wrap: break-word;
        }

        .settings-section {
            margin-bottom: 24px;
        }

        .settings-section h3 {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 16px;
            color: var(--text-primary);
        }

        .setting-item {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 12px;
        }

        .setting-item label {
            font-size: 14px;
            color: var(--text-secondary);
        }

        .setting-item select,
        .setting-item input[type="checkbox"] {
            flex: 1;
            padding: 8px 12px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            background: var(--input-bg);
            color: var(--text-primary);
            font-size: 14px;
            font-family: inherit;
        }

        .setting-item select:focus,
        .setting-item input[type="checkbox"]:focus {
            border-color: var(--accent-color);
            box-shadow: 0 0 0 2px rgba(88, 166, 255, 0.2);
        }

        .setting-item input[type="checkbox"] {
            width: 20px;
            height: 20px;
            accent-color: var(--accent-color);
        }
    </style>
    </style>
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <div class="sidebar">
            <div class="sidebar-header" onclick="startNewChatFromLogo()" style="cursor: pointer;">
                <div class="logo">
                    <i class="fas fa-robot"></i>
            </div>
                <h1>AI Asistan</h1>
            </div>
            
            <div class="chat-tabs" id="chatTabs">
                <!-- Chat tabs will be populated here automatically -->
        </div>

            <!-- Sidebar footer removed -->
            </div>

        <!-- Main Chat Area -->
        <div class="chat-main">
            <div class="chat-header">
                <h2 id="currentChatTitle">Yeni Sohbet</h2>
                <div class="header-controls">
                    <div class="status-indicator" id="statusIndicator">
                        <i class="fas fa-circle"></i>
                        <span>Ã‡evrimiÃ§i</span>
                                </div>
                    <!-- Clear button removed -->
                    <!-- Hamburger button removed -->
                            </div>
                        </div>
                        
            <!-- Chat Messages Panel -->
            <div class="chat-messages" id="chatMessages">
                <!-- Welcome message -->
                <div class="welcome-message">
                    <h1>ðŸ¤– AI Asistan'a HoÅŸ Geldiniz</h1>
                    <p>GeliÅŸmiÅŸ yapay zeka teknolojisi ile sohbet edin, sorularÄ±nÄ±zÄ± sorun ve yaratÄ±cÄ± Ã§Ã¶zÃ¼mler bulun.</p>
                    
                    <div class="feature-grid">
                        <div class="feature-card">
                            <i class="fas fa-brain"></i>
                            <h3>GeliÅŸmiÅŸ AI</h3>
                            <p>En son yapay zeka teknolojileri ile gÃ¼Ã§lendirilmiÅŸ</p>
                            </div>
                        <div class="feature-card">
                            <i class="fas fa-comments"></i>
                            <h3>DoÄŸal Sohbet</h3>
                            <p>Ä°nsan benzeri doÄŸal dil iÅŸleme</p>
                        </div>
                        <div class="feature-card">
                            <i class="fas fa-lightbulb"></i>
                            <h3>YaratÄ±cÄ± Ã‡Ã¶zÃ¼mler</h3>
                            <p>KarmaÅŸÄ±k problemler iÃ§in yaratÄ±cÄ± yaklaÅŸÄ±mlar</p>
                    </div>
                        <div class="feature-card">
                            <i class="fas fa-shield-alt"></i>
                            <h3>GÃ¼venli</h3>
                            <p>GÃ¼venli ve Ã¶zel sohbet deneyimi</p>
                </div>
                                </div>
                            </div>
                        </div>
                        
            <!-- Features Panel -->
            <div class="panel" id="featuresPanel" style="display: none;">
                <div class="panel-header">
                    <h2><i class="fas fa-star"></i> AI Asistan Ã–zellikleri</h2>
                        </div>
                <div class="panel-content">
                    <div class="feature-grid">
                        <div class="feature-card">
                            <i class="fas fa-brain"></i>
                            <h3>GeliÅŸmiÅŸ NLP</h3>
                            <p>DoÄŸal dil iÅŸleme ile kullanÄ±cÄ± niyetlerini anlar ve uygun yanÄ±tlar Ã¼retir.</p>
                            </div>
                        <div class="feature-card">
                            <i class="fas fa-memory"></i>
                            <h3>HafÄ±za Sistemi</h3>
                            <p>KÄ±sa ve uzun sÃ¼reli hafÄ±za ile konuÅŸma geÃ§miÅŸini hatÄ±rlar.</p>
                        </div>
                        <div class="feature-card">
                            <i class="fas fa-lightbulb"></i>
                            <h3>YaratÄ±cÄ±lÄ±k ModÃ¼lÃ¼</h3>
                            <p>Metaforlar, benzetmeler ve yaratÄ±cÄ± sorular ile zengin yanÄ±tlar.</p>
                    </div>
                        <div class="feature-card">
                            <i class="fas fa-cogs"></i>
                            <h3>AkÄ±l YÃ¼rÃ¼tme</h3>
                            <p>MantÄ±ksal baÄŸlantÄ±lar kurar ve baÄŸlam analizi yapar.</p>
                </div>
                        <div class="feature-card">
                            <i class="fas fa-database"></i>
                            <h3>Bilgi TabanÄ±</h3>
                            <p>GeniÅŸ bilgi tabanÄ±ndan ilgili bilgileri Ã§Ä±karÄ±r ve sunar.</p>
            </div>
                        <div class="feature-card">
                            <i class="fas fa-chart-line"></i>
                            <h3>Performans Takibi</h3>
                            <p>DetaylÄ± performans metrikleri ve sistem durumu izleme.</p>
        </div>
                </div>
                </div>
            </div>
            
            <!-- Stats Panel -->
            <div class="panel" id="statsPanel" style="display: none;">
                <div class="panel-header">
                    <h2><i class="fas fa-chart-bar"></i> Sistem Ä°statistikleri</h2>
                </div>
                <div class="panel-content">
                    <div class="stats-grid" id="statsGrid">
                        <!-- Stats will be populated here -->
                    </div>
                </div>
            </div>
            
            <!-- Debug Panel -->
            <div class="panel" id="debugPanel" style="display: none;">
                <div class="panel-header">
                    <h2><i class="fas fa-bug"></i> Debug Bilgileri</h2>
                </div>
                <div class="panel-content">
                    <div class="debug-buttons">
                        <button onclick="checkSystemStatus()" class="btn btn-primary">Sistem Durumu</button>
                        <button onclick="loadStats()" class="btn btn-info">Ä°statistikler</button>
                        <button onclick="loadDebugInfo()" class="btn btn-warning">Debug Bilgileri</button>
                        <button onclick="loadLatestErrors()" class="btn btn-danger">En Son Hatalar</button>
                        <button onclick="clearChat()" class="btn btn-secondary">Sohbeti Temizle</button>
                        <button onclick="deleteAllChats()" class="btn btn-danger">TÃ¼m Sohbetleri Sil</button>
                        <button onclick="clearAllData()" class="btn btn-danger">TÃ¼m Verileri Temizle</button>
                    </div>
                    <div class="debug-content" id="debugContent">
                        <!-- Debug info will be populated here -->
                    </div>
                </div>
            </div>
            
            <!-- Settings Panel -->
            <div class="panel" id="settingsPanel" style="display: none;">
                <div class="panel-header">
                    <h2><i class="fas fa-cog"></i> Ayarlar</h2>
                </div>
                <div class="panel-content">
                    <div class="settings-section">
                        <h3>GÃ¶rÃ¼nÃ¼m AyarlarÄ±</h3>
                        <div class="setting-item">
                            <label for="themeSelect">Tema:</label>
                            <select id="themeSelect" onchange="changeTheme(this.value)">
                                <option value="dark">Koyu Tema</option>
                                <option value="light">AÃ§Ä±k Tema</option>
                                <option value="auto">Otomatik</option>
                            </select>
                </div>
                        <div class="setting-item">
                            <label for="fontSizeSelect">YazÄ± Boyutu:</label>
                            <select id="fontSizeSelect" onchange="changeFontSize(this.value)">
                                <option value="small">KÃ¼Ã§Ã¼k</option>
                                <option value="medium" selected>Orta</option>
                                <option value="large">BÃ¼yÃ¼k</option>
                            </select>
            </div>
                </div>
                    <div class="settings-section">
                        <h3>Chat AyarlarÄ±</h3>
                        <div class="setting-item">
                            <label for="autoScroll">Otomatik KaydÄ±rma:</label>
                            <input type="checkbox" id="autoScroll" checked>
                        </div>
                        <div class="setting-item">
                            <label for="typingIndicator">YazÄ±yor GÃ¶stergesi:</label>
                            <input type="checkbox" id="typingIndicator" checked>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="error-message" id="errorMessage"></div>

            <div class="typing-indicator" id="typingIndicator">
                <div class="typing-dots">
                    <div class="typing-dot"></div>
                    <div class="typing-dot"></div>
                    <div class="typing-dot"></div>
                </div>
            </div>

            <div class="chat-input-container">
                <div class="chat-input-wrapper">
                    <textarea 
                        class="chat-input" 
                        id="chatInput" 
                        placeholder="MesajÄ±nÄ±zÄ± yazÄ±n... (Shift+Enter ile yeni satÄ±r)"
                        rows="1"
                        onkeydown="handleKeyDown(event)"
                    ></textarea>
                    <button class="send-btn" id="sendBtn" onclick="sendMessage()">
                        <i class="fas fa-paper-plane"></i>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Global variables
        let currentSessionId = null;
        let chatHistory = [];
        let isTyping = false;
        let chatSessions = {}; // Store all chat sessions

        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
            setupEventListeners();
            loadChatSessions();
        });

        function initializeApp() {
            // Check connection status
            checkConnectionStatus();
            
            // Auto-resize textarea
            const chatInput = document.getElementById('chatInput');
            chatInput.addEventListener('input', autoResizeTextarea);
            
            // Focus on input
            chatInput.focus();
        }

        function setupEventListeners() {
            // Handle input focus
            document.getElementById('chatInput').addEventListener('focus', function() {
                this.parentElement.style.borderColor = 'var(--accent-color)';
            });

            document.getElementById('chatInput').addEventListener('blur', function() {
                this.parentElement.style.borderColor = 'var(--border-color)';
            });

            // Removed auto-tab creation on input - tabs only created when messages are sent
        }

        function autoResizeTextarea() {
            const textarea = this;
            textarea.style.height = 'auto';
            textarea.style.height = Math.min(textarea.scrollHeight, 120) + 'px';
        }

        function handleKeyDown(event) {
            if (event.key === 'Enter' && !event.shiftKey) {
                event.preventDefault();
                
                // Auto-create new chat if no current session
                if (!currentSessionId) {
                    console.log('Enter pressed without session, auto-creating new chat');
                    startNewChat();
                }
                
                // Tab will be created automatically when message is added
                
                sendMessage();
            }
        }

        function startNewChat() {
            console.log('Starting new chat...');
            currentSessionId = 'session_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
            chatHistory = [];
            
            // Create new session
            chatSessions[currentSessionId] = {
                id: currentSessionId,
                title: 'Yeni Sohbet',
                messages: [],
                created: new Date().toISOString(),
                lastModified: new Date().toISOString()
            };
            
            console.log('Created new session:', chatSessions[currentSessionId]);
            
            // Update UI
            document.getElementById('currentChatTitle').textContent = 'AI Asistan';
            document.getElementById('chatMessages').innerHTML = getWelcomeMessage();
            
            // Don't add chat tab yet - wait for first message
            console.log('New chat started, waiting for first message to add tab');
            
            // Save to localStorage
            saveChatSessions();
            
            console.log('New chat started successfully');
        }

        function startNewChatFromLogo() {
            console.log('Starting new chat from logo...');
            currentSessionId = 'session_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
            chatHistory = [];
            
            // Create new session
            chatSessions[currentSessionId] = {
                id: currentSessionId,
                title: 'Yeni Sohbet',
                messages: [],
                created: new Date().toISOString(),
                lastModified: new Date().toISOString()
            };
            
            console.log('Created new session from logo:', chatSessions[currentSessionId]);
            
            // Update UI - NO TAB ADDED YET
            document.getElementById('currentChatTitle').textContent = 'AI Asistan';
            document.getElementById('chatMessages').innerHTML = getWelcomeMessage();
            
            // Save to localStorage
            saveChatSessions();
            
            console.log('New chat started successfully from logo (no tab added yet)');
        }

        function addChatTab(title, sessionId) {
            const chatTabs = document.getElementById('chatTabs');
            const tabId = 'tab_' + sessionId;
            
            // Remove existing tab if it exists
            const existingTab = document.getElementById(tabId);
            if (existingTab) {
                existingTab.remove();
            }
            
            // Check if session has messages - don't show tabs with 0 messages
            const session = chatSessions[sessionId];
            if (!session || session.messages.length === 0) {
                console.log('Session has no messages, not adding tab:', sessionId);
                return;
            }
            
            const tab = document.createElement('div');
            tab.className = 'chat-tab';
            tab.id = tabId;
            tab.onclick = () => switchToChat(sessionId, title);
            
            const createdDate = new Date(session.created).toLocaleDateString('tr-TR', { month: 'numeric', day: 'numeric', hour: 'numeric', minute: 'numeric' });

            const messageCount = session.messages.length;
            const messageCountText = messageCount > 0 ? `${messageCount} mesaj` : 'BoÅŸ';
            
            tab.innerHTML = `
                <i class="fas fa-comment tab-icon"></i>
                <div class="tab-content">
                    <span class="tab-title">${title}</span>
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <span class="tab-date">${createdDate}</span>
                        <span class="tab-date" style="font-size: 10px; opacity: 0.5;">${messageCountText}</span>
                    </div>
                </div>
                <div class="tab-actions">
                    <button onclick="deleteChatTab('${sessionId}', event)" class="delete-btn">
                        <i class="fas fa-trash"></i>
                    </button>
                </div>
            `;
            
            chatTabs.appendChild(tab);
            
            // Set as active
            setActiveTab(tabId);
            
            console.log('Chat tab added for session with', messageCount, 'messages:', sessionId);
        }

        function setActiveTab(tabId) {
            // Remove active class from all tabs
            document.querySelectorAll('.chat-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Add active class to current tab
            const currentTab = document.getElementById(tabId);
            if (currentTab) {
                currentTab.classList.add('active');
            }
        }

        function switchToChat(sessionId, title) {
            console.log('Switching to chat:', sessionId, title);
            currentSessionId = sessionId;
            const session = chatSessions[sessionId];
            
            if (session) {
                console.log('Session found:', session);
                // Load chat history
                chatHistory = session.messages;
                console.log('Loaded', chatHistory.length, 'messages from session');
                document.getElementById('currentChatTitle').textContent = session.title;
                
                // Display messages
                displayChatHistory();
                
                // Set active tab
                setActiveTab('tab_' + sessionId);
                
                console.log('Successfully switched to chat:', sessionId);
            } else {
                console.error('Session not found:', sessionId);
                // Session not found, start new chat
                startNewChat();
            }
        }

        function displayChatHistory() {
            console.log('Displaying chat history with', chatHistory.length, 'messages');
            const chatMessages = document.getElementById('chatMessages');
            
            if (chatHistory.length === 0) {
                console.log('No messages in history, showing welcome message');
                chatMessages.innerHTML = getWelcomeMessage();
                return;
            }
            
            // Clear and add messages
            chatMessages.innerHTML = '';
            chatHistory.forEach((msg, index) => {
                console.log('Adding message', index + 1, 'to UI:', msg.type, msg.content.substring(0, 50) + '...');
                addMessageToUI(msg.type, msg.content, msg.timestamp, false);
            });
            
            // Scroll to bottom
            chatMessages.scrollTop = chatMessages.scrollHeight;
            console.log('Chat history displayed successfully');
        }

        function deleteChatTab(sessionId, event) {
            event.stopPropagation();
            console.log('Deleting chat tab:', sessionId);
            
            if (confirm('Bu sohbeti silmek istediÄŸinizden emin misiniz?')) {
                try {
                    // Remove from sessions
                    delete chatSessions[sessionId];
                    console.log('Session removed from chatSessions');
                    
                    // Remove tab from UI
                    const tab = document.getElementById('tab_' + sessionId);
                    if (tab) {
                        tab.remove();
                        console.log('Tab removed from UI');
                        } else {
                        console.warn('Tab not found in UI:', 'tab_' + sessionId);
                    }
                    
                    // If this was the current chat, start a new one
                    if (currentSessionId === sessionId) {
                        console.log('Current session deleted, starting new chat');
                        startNewChat();
                    } else {
                        // Update the current session display if needed
                        console.log('Other session deleted, current session remains');
                    }
                    
                    // Save to localStorage
                    saveChatSessions();
                    
                    console.log('Chat tab deletion completed successfully');
                    
                } catch (error) {
                    console.error('Error deleting chat tab:', error);
                    showError('Sohbet silinirken bir hata oluÅŸtu: ' + error.message);
                }
            }
        }

        function loadChatSessions() {
            try {
                console.log('Loading chat sessions from localStorage...');
                const saved = localStorage.getItem('chatSessions');
                console.log('Raw localStorage data:', saved);
                
                if (saved) {
                    chatSessions = JSON.parse(saved);
                    console.log('Parsed chat sessions:', chatSessions);
                    
                    // Clean up sessions with 0 messages automatically
                    const sessionsToRemove = [];
                    Object.keys(chatSessions).forEach(sessionId => {
                        const session = chatSessions[sessionId];
                        if (!session.messages || session.messages.length === 0) {
                            console.log('Found session with 0 messages, marking for removal:', sessionId);
                            sessionsToRemove.push(sessionId);
                        }
                    });
                    
                    // Remove empty sessions
                    sessionsToRemove.forEach(sessionId => {
                        console.log('Removing empty session:', sessionId);
                        delete chatSessions[sessionId];
                    });
                    
                    if (sessionsToRemove.length > 0) {
                        console.log('Removed', sessionsToRemove.length, 'empty sessions');
                        // Save cleaned sessions to localStorage
                        saveChatSessions();
                    }
                    
                    // Sort sessions by last modified date (newest first)
                    const sortedSessions = Object.values(chatSessions).sort((a, b) => 
                        new Date(b.lastModified) - new Date(a.lastModified)
                    );
                    
                    console.log('Sorted sessions after cleanup:', sortedSessions);
                    
                    // Load existing tabs in order (only for sessions with messages)
                    sortedSessions.forEach(session => {
                        if (session.messages && session.messages.length > 0) {
                            console.log('Adding tab for session with', session.messages.length, 'messages:', session.id, session.title);
                            addChatTab(session.title, session.id);
                        } else {
                            console.log('Skipping session with no messages:', session.id);
                        }
                    });
                    
                    // Don't automatically load any session - show welcome message instead
                    // User can manually click on any chat tab to continue
                    console.log('Chat sessions loaded, showing welcome message');
                    showWelcomeMessage();
                } else {
                    console.log('No saved sessions found in localStorage, starting new chat');
                    startNewChat();
                }
            } catch (error) {
                console.error('Error loading chat sessions:', error);
                // Clear corrupted data and start fresh
                localStorage.removeItem('chatSessions');
                startNewChat();
            }
        }

        function saveChatSessions() {
            try {
                console.log('Saving chat sessions to localStorage:', chatSessions);
                const dataToSave = JSON.stringify(chatSessions);
                console.log('Data to save:', dataToSave);
                localStorage.setItem('chatSessions', dataToSave);
                console.log('Chat sessions saved successfully');
                
                // Verify the save
                const saved = localStorage.getItem('chatSessions');
                console.log('Verification - saved data:', saved);
                
            } catch (error) {
                console.error('Error saving chat sessions:', error);
                showError('Sohbet geÃ§miÅŸi kaydedilemedi: ' + error.message);
            }
        }

        function showWelcomeMessage() {
            // Show welcome message in chat area
            document.getElementById('chatMessages').innerHTML = getWelcomeMessage();
            document.getElementById('currentChatTitle').textContent = 'AI Asistan';
            
            // Clear current session
                currentSessionId = null;
            chatHistory = [];
        }

        function getWelcomeMessage() {
            return `
                <div class="welcome-message">
                    <h1>ðŸ¤– AI Asistan'a HoÅŸ Geldiniz</h1>
                    <p>GeliÅŸmiÅŸ yapay zeka teknolojisi ile sohbet edin, sorularÄ±nÄ±zÄ± sorun ve yaratÄ±cÄ± Ã§Ã¶zÃ¼mler bulun.</p>
                    

                `;
        }

        async function sendMessage() {
            const input = document.getElementById('chatInput');
            const message = input.value.trim();
            
            if (!message || isTyping) return;
            
            // Clear input
            input.value = '';
            input.style.height = 'auto';
            
            // Add user message to chat
            addMessage('user', message);
            
            // Show typing indicator
            showTypingIndicator();
            
            try {
                // Send message to API
                const response = await fetch('/chat', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        message: message,
                        session_id: currentSessionId
                    })
                });
                
                if (response.ok) {
                    const data = await response.json();
                    
                    // Hide typing indicator
                    hideTypingIndicator();
                    
                    // Add bot response
                    addMessage('bot', data.response);
                    
                    // Update chat tab title with first message
                    if (chatHistory.length === 2) { // User message + bot response
                        const shortTitle = message.substring(0, 30) + (message.length > 30 ? '...' : '');
                        updateChatTabTitle(shortTitle);
                        updateSessionTitle(shortTitle);
                    }
                    
                } else {
                    throw new Error('API response error');
                }
                
            } catch (error) {
                console.error('Error sending message:', error);
                hideTypingIndicator();
                showError('Mesaj gÃ¶nderilirken bir hata oluÅŸtu. LÃ¼tfen tekrar deneyin.');
            }
        }

        function addMessage(type, content) {
            console.log('Adding message:', type, content);
            
            const timestamp = new Date().toLocaleTimeString('tr-TR', { 
                hour: '2-digit', 
                minute: '2-digit' 
            });
            
            // Add to history
            const messageObj = { type, content, timestamp };
            chatHistory.push(messageObj);
            
            console.log('Message added to history, total messages:', chatHistory.length);
            
            // Update session
            if (currentSessionId && chatSessions[currentSessionId]) {
                chatSessions[currentSessionId].messages = chatHistory;
                chatSessions[currentSessionId].lastModified = new Date().toISOString();
                
                console.log('Updating session:', currentSessionId, 'with', chatHistory.length, 'messages');
                
                // Save to localStorage immediately after each message
                saveChatSessions();
                
                // If this is the first message, create the chat tab
                if (chatHistory.length === 1 && !document.getElementById('tab_' + currentSessionId)) {
                    console.log('First message added, creating chat tab');
                    addChatTab('Yeni Sohbet', currentSessionId);
                } else {
                    // Update existing tab display
                    updateChatTabDisplay(currentSessionId);
                }
            } else {
                console.error('No current session found for message:', currentSessionId);
            }
            
            // Add to UI
            addMessageToUI(type, content, timestamp, true);
        }

        function addMessageToUI(type, content, timestamp, scrollToBottom = true) {
            const chatMessages = document.getElementById('chatMessages');
            
            // Remove welcome message if it exists
            const welcomeMessage = chatMessages.querySelector('.welcome-message');
            if (welcomeMessage) {
                welcomeMessage.remove();
            }
            
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${type}`;
            
            const avatar = type === 'user' ? 'ðŸ‘¤' : 'ðŸ¤–';
            
            messageDiv.innerHTML = `
                <div class="message-avatar">${avatar}</div>
                <div class="message-content">
                    ${content}
                    <div class="message-time">${timestamp}</div>
                        </div>
            `;
            
            chatMessages.appendChild(messageDiv);
            
            // Scroll to bottom if requested
            if (scrollToBottom) {
                chatMessages.scrollTop = chatMessages.scrollHeight;
            }
        }

        function updateChatTabDisplay(sessionId) {
            const session = chatSessions[sessionId];
            if (!session) {
                console.warn('Session not found for tab update:', sessionId);
                return;
            }
            
            const tab = document.getElementById('tab_' + sessionId);
            if (!tab) {
                console.warn('Tab not found for update:', sessionId);
                return;
            }
            
            try {
                const createdDate = new Date(session.created).toLocaleDateString('tr-TR', { 
                    month: 'numeric', 
                    day: 'numeric', 
                    hour: 'numeric', 
                    minute: 'numeric' 
                });
                const messageCount = session.messages.length;
                const messageCountText = messageCount > 0 ? `${messageCount} mesaj` : 'BoÅŸ';
                
                // If session has no messages, hide the tab
                if (messageCount === 0) {
                    console.log('Session has no messages, hiding tab:', sessionId);
                    tab.style.display = 'none';
                    return;
                    } else {
                    // Show the tab if it was hidden
                    tab.style.display = 'flex';
                }
                
                const tabContent = tab.querySelector('.tab-content');
                if (tabContent) {
                    tabContent.innerHTML = `
                        <span class="tab-title">${session.title}</span>
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <span class="tab-date">${createdDate}</span>
                            <span class="tab-date" style="font-size: 10px; opacity: 0.5;">${messageCountText}</span>
                        </div>
                    `;
                    console.log('Tab display updated for session:', sessionId);
                } else {
                    console.warn('Tab content not found for session:', sessionId);
                }
            } catch (error) {
                console.error('Error updating tab display for session:', sessionId, error);
            }
        }

        function updateChatTabTitle(title) {
            const currentTab = document.querySelector('.chat-tab.active .tab-title');
            if (currentTab) {
                currentTab.textContent = title;
            }
        }

        function updateSessionTitle(title) {
            if (currentSessionId && chatSessions[currentSessionId]) {
                chatSessions[currentSessionId].title = title;
                saveChatSessions();
                
                // Update tab display
                updateChatTabDisplay(currentSessionId);
            }
        }

        function showTypingIndicator() {
            isTyping = true;
            document.getElementById('typingIndicator').classList.add('show');
            
            const chatMessages = document.getElementById('chatMessages');
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        function hideTypingIndicator() {
            isTyping = false;
            document.getElementById('typingIndicator').classList.remove('show');
        }

        function showError(message) {
            const errorDiv = document.getElementById('errorMessage');
            errorDiv.textContent = message;
            errorDiv.classList.add('show');
            
            setTimeout(() => {
                errorDiv.classList.remove('show');
            }, 5000);
        }

        async function clearChat() {
            console.log('Clearing current chat...');
            
            if (confirm('Sohbet geÃ§miÅŸini temizlemek istediÄŸinizden emin misiniz?')) {
                try {
                    // Log session summary before clearing
                    if (currentSessionId && chatSessions[currentSessionId] && chatHistory.length > 0) {
                        try {
                            const sessionStartTime = new Date(chatSessions[currentSessionId].created);
                            const sessionEndTime = new Date();
                            const sessionDuration = (sessionEndTime - sessionStartTime) / 1000; // seconds
                            
                            await fetch('/api/chat/session-summary', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ 
                                    session_id: currentSessionId,
                                    messages: chatHistory,
                                    session_duration: sessionDuration
                                })
                            });
                            console.log('Session summary logged before clearing');
                        } catch (logError) {
                            console.warn('Failed to log session summary:', logError);
                        }
                    }
                    
                    chatHistory = [];
                    console.log('Chat history cleared');
                    
                    // Update session
                    if (currentSessionId && chatSessions[currentSessionId]) {
                        chatSessions[currentSessionId].messages = [];
                        chatSessions[currentSessionId].lastModified = new Date().toISOString();
                        chatSessions[currentSessionId].title = 'Yeni Sohbet';
                        
                        console.log('Session updated with empty messages');
                        
                        // Save to localStorage
                        saveChatSessions();
                        
                        // Update tab display (this will hide the tab since it has 0 messages)
                        updateChatTabDisplay(currentSessionId);
                        
                        // Also remove the tab from UI completely
                        const tab = document.getElementById('tab_' + currentSessionId);
                        if (tab) {
                            tab.remove();
                            console.log('Tab removed from UI after clearing chat');
                        }
                        
                    } else {
                        console.warn('No current session found for clearing');
                    }
                    
                    // Update UI
                    document.getElementById('chatMessages').innerHTML = getWelcomeMessage();
                    document.getElementById('currentChatTitle').textContent = 'AI Asistan';
                    
                    console.log('Chat cleared successfully');
                    
                } catch (error) {
                    console.error('Error clearing chat:', error);
                    showError('Sohbet temizlenirken bir hata oluÅŸtu: ' + error.message);
                }
            }
        }

        async function clearAllData() {
            console.log('Clearing all data...');
            
            if (confirm('TÃœM sohbet verileri ve localStorage temizlenecek. Bu iÅŸlem geri alÄ±namaz! Devam etmek istiyor musunuz?')) {
                try {
                    // Log all session summaries before clearing
                    for (const [sessionId, session] of Object.entries(chatSessions)) {
                        if (session.messages && session.messages.length > 0) {
                            try {
                                const sessionStartTime = new Date(session.created);
                                const sessionEndTime = new Date();
                                const sessionDuration = (sessionEndTime - sessionStartTime) / 1000; // seconds
                                
                                await fetch('/api/chat/session-summary', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ 
                                        session_id: sessionId,
                                        messages: session.messages,
                                        session_duration: sessionDuration
                                    })
                                });
                                console.log(`Session summary logged for ${sessionId}`);
                            } catch (logError) {
                                console.warn(`Failed to log session summary for ${sessionId}:`, logError);
                            }
                        }
                    }
                    
                    // Clear all sessions
                    chatSessions = {};
                    chatHistory = [];
                    currentSessionId = null;
                    
                    console.log('All sessions cleared');
                    
                    // Clear localStorage
                    localStorage.removeItem('chatSessions');
                    console.log('localStorage cleared');
                    
                    // Clear UI
                    document.getElementById('chatTabs').innerHTML = '';
                    document.getElementById('chatMessages').innerHTML = getWelcomeMessage();
                    document.getElementById('currentChatTitle').textContent = 'AI Asistan';
                    
                    // Start fresh
                    startNewChat();
                    
                    console.log('All data cleared successfully');
                    showError('TÃ¼m veriler temizlendi, yeni baÅŸlangÄ±Ã§ yapÄ±ldÄ±');
                    
                } catch (error) {
                    console.error('Error clearing all data:', error);
                    showError('Veriler temizlenirken bir hata oluÅŸtu: ' + error.message);
                }
            }
        }

        async function checkConnectionStatus() {
            try {
                const response = await fetch('/health');
                if (response.ok) {
                    document.getElementById('statusIndicator').classList.remove('offline');
                    document.getElementById('statusIndicator').innerHTML = '<i class="fas fa-circle"></i><span>Ã‡evrimiÃ§i</span>';
                } else {
                    throw new Error('Health check failed');
                }
            } catch (error) {
                document.getElementById('statusIndicator').classList.add('offline');
                document.getElementById('statusIndicator').innerHTML = '<i class="fas fa-circle"></i><span>Ã‡evrimdÄ±ÅŸÄ±</span>';
            }
        }

        function showPanel(panelName) {
            // Hide all panels
            document.querySelectorAll('.panel').forEach(panel => {
                panel.classList.remove('show');
            });

            // Hide chat messages
            document.getElementById('chatMessages').style.display = 'none';

            // Show the selected panel
            document.getElementById(panelName + 'Panel').classList.add('show');

            // Sidebar menu item update removed
        }

        // showChat function removed

        // toggleSidebar function removed

        // Periodic connection check
        setInterval(checkConnectionStatus, 30000); // Check every 30 seconds
        
        // Log session summary when page is about to unload
        window.addEventListener('beforeunload', async function(event) {
            if (currentSessionId && chatSessions[currentSessionId] && chatHistory.length > 0) {
                try {
                    const sessionStartTime = new Date(chatSessions[currentSessionId].created);
                    const sessionEndTime = new Date();
                    const sessionDuration = (sessionEndTime - sessionStartTime) / 1000; // seconds
                    
                    // Use sendBeacon for reliable logging during page unload
                    const data = {
                        session_id: currentSessionId,
                        messages: chatHistory,
                        session_duration: sessionDuration
                    };
                    
                    // Create blob with proper content type
                    const blob = new Blob([JSON.stringify(data)], { type: 'application/json' });
                    navigator.sendBeacon('/api/chat/session-summary', blob);
                    console.log('Session summary logged on page unload');
                } catch (error) {
                    console.warn('Failed to log session summary on unload:', error);
                }
            }
        });

        // Panel functionality functions
        async function loadStats() {
            try {
                const response = await fetch('/api/stats');
                const data = await response.json();
                
                if (data.error) {
                    throw new Error(data.error);
                }
                
                const statsGrid = document.getElementById('statsGrid');
                statsGrid.innerHTML = `
                    <div class="feature-card">
                        <i class="fas fa-chart-line"></i>
                        <h3>${data.total_requests || 0}</h3>
                        <p>Toplam Ä°stek</p>
                        </div>
                    <div class="feature-card">
                        <i class="fas fa-check-circle"></i>
                        <h3>${data.successful_requests || 0}</h3>
                        <p>BaÅŸarÄ±lÄ± Ä°stek</p>
                        </div>
                    <div class="feature-card">
                        <i class="fas fa-percentage"></i>
                        <h3>${Math.round((data.successful_requests || 0) / Math.max(data.total_requests || 1, 1) * 100)}%</h3>
                        <p>BaÅŸarÄ± OranÄ±</p>
                        </div>
                    <div class="feature-card">
                        <i class="fas fa-clock"></i>
                        <h3>${Math.round((data.average_response_time || 0) * 1000)}ms</h3>
                        <p>Ortalama YanÄ±t SÃ¼resi</p>
                        </div>
                    <div class="feature-card">
                        <i class="fas fa-comments"></i>
                        <h3>${chatHistory.length}</h3>
                        <p>Bu Oturumda Mesaj</p>
                        </div>
                    <div class="feature-card">
                        <i class="fas fa-server"></i>
                        <h3>${Math.round((data.uptime || 0) / 60)}m</h3>
                        <p>Ã‡alÄ±ÅŸma SÃ¼resi</p>
                    </div>
                `;
                
            } catch (error) {
                console.error('Error loading stats:', error);
                document.getElementById('statsGrid').innerHTML = '<p>Ä°statistikler yÃ¼klenemedi: ' + error.message + '</p>';
            }
        }

        async function loadDebugInfo() {
            try {
                const response = await fetch('/api/debug/info');
                const data = await response.json();
                
                if (data.error) {
                    throw new Error(data.error);
                }
                
                const debugContent = document.getElementById('debugContent');
                debugContent.innerHTML = JSON.stringify(data, null, 2);
                
            } catch (error) {
                console.error('Error loading debug info:', error);
                document.getElementById('debugContent').innerHTML = 'Debug bilgileri yÃ¼klenemedi: ' + error.message;
            }
        }

        async function loadLatestErrors() {
            try {
                const response = await fetch('/api/logs/latest-errors');
                const data = await response.json();
                
                if (data.error) {
                    throw new Error(data.error);
                }
                
                const debugContent = document.getElementById('debugContent');
                debugContent.innerHTML = `
                    <div style="margin-bottom: 16px;">
                        <h4 style="color: var(--error-color); margin-bottom: 8px;">ðŸ”´ En Son Hatalar</h4>
                        <p><strong>Hata Dizini:</strong> ${data.errors_directory || 'Bilinmiyor'}</p>
                        </div>
                    <div style="margin-bottom: 16px;">
                        <h4 style="color: var(--warning-color); margin-bottom: 8px;">ðŸ“ Hata DosyalarÄ±:</h4>
                        <pre style="background: var(--primary-bg); padding: 8px; border-radius: 4px; font-size: 12px;">${data.latest_errors?.all_error_files ? data.latest_errors.all_error_files.map(file => `${file.filename} (${file.size_mb} MB) - ${file.modified}`).join('\n') : 'Hata dosyasÄ± bulunamadÄ±'}</pre>
                        </div>
                    <div>
                        <h4 style="color: var(--accent-color); margin-bottom: 8px;">ðŸ“‹ En Son Hata DetaylarÄ±:</h4>
                        <pre style="background: var(--primary-bg); padding: 8px; border-radius: 4px; font-size: 12px; max-height: 200px; overflow-y: auto;">${data.latest_errors?.latest_error_details || 'Hata detayÄ± bulunamadÄ±'}</pre>
                        </div>
                    `;
                
            } catch (error) {
                console.error('Error loading latest errors:', error);
                document.getElementById('debugContent').innerHTML = 'En son hatalar yÃ¼klenemedi: ' + error.message;
            }
        }

        async function checkSystemStatus() {
            try {
                const response = await fetch('/health');
                const data = await response.json();
                
                const debugContent = document.getElementById('debugContent');
                debugContent.innerHTML = `
                    <div style="margin-bottom: 16px;">
                        <h4 style="color: var(--success-color); margin-bottom: 8px;">ðŸŸ¢ Sistem Durumu</h4>
                        <pre style="background: var(--primary-bg); padding: 8px; border-radius: 4px; font-size: 12px;">${JSON.stringify(data, null, 2)}</pre>
                                </div>
                            `;
                
            } catch (error) {
                console.error('Error checking system status:', error);
                document.getElementById('debugContent').innerHTML = 'Sistem durumu kontrol edilemedi: ' + error.message;
            }
        }

        /* Theme and Font Size Functions */
        function changeTheme(theme) {
            if (theme === 'dark') {
                document.body.classList.add('dark-mode');
                document.body.classList.remove('light-mode', 'auto-mode');
            } else if (theme === 'light') {
                document.body.classList.add('light-mode');
                document.body.classList.remove('dark-mode', 'auto-mode');
            } else { // auto
                document.body.classList.add('auto-mode');
                document.body.classList.remove('dark-mode', 'light-mode');
            }
            localStorage.setItem('theme', theme);
        }

        function changeFontSize(size) {
            document.body.style.fontSize = size;
            localStorage.setItem('fontSize', size);
        }

        /* Initial Theme and Font Size */
        document.addEventListener('DOMContentLoaded', function() {
            const savedTheme = localStorage.getItem('theme');
            const savedFontSize = localStorage.getItem('fontSize');

            if (savedTheme) {
                changeTheme(savedTheme);
            } else {
                changeTheme('dark'); // Default to dark theme
            }

            if (savedFontSize) {
                changeFontSize(savedFontSize);
            } else {
                changeFontSize('medium'); // Default to medium font size
            }
        });
    </script>
</body>
</html>